[workspace]
authors = ["sis92 <feel8.fun@gmail.com>"]
channels = ["conda-forge"]
name = "feel8-build"
version = "0.1.0"
description = "Feel8 meta package"
platforms = ["win-64", "linux-64"]
preview = ["pixi-build"]

[package]
name = { workspace = true }

[package.build]
backend = { name = "pixi-build-cmake", version = "0.3.*" }

[package.build.config]
extra-args = ["-DCMAKE_BUILD_TYPE=Release"]

[system-requirements]
# Pixi uses `system-requirements` to determine the compatible manylinux tag for PyPI wheels on linux.
# PySide6 6.10.1 wheels are published as `manylinux_2_34_x86_64`, so we must require glibc >= 2.34
# for the linux environment solve to succeed.
libc = { family = "glibc", version = "2.34" }

[feature.python.dependencies]
python = ">=3.14.3,<3.15"
pip = ">=26.0.1,<27"

[feature.vision.pypi-dependencies]
numpy = ">=2.4.2, <3"
opencv-contrib-python = ">=4.13.0.92, <5"

[feature.onnx.pypi-dependencies]
f8pydl = { path = "packages/f8pydl", editable = true }
onnxruntime-gpu = ">=1.24.2, <2"
pyyaml = ">=6.0.3, <7"

[feature.onnx.tasks]
f8pydl_detector = "python -m f8pydl.main_detector"
f8pydl_humandetector = "python -m f8pydl.main_humandetector"
f8pydl_classifier = "python -m f8pydl.main_classifier"
f8pydl_bench = "python scripts/bench_dl_baseline.py"

[feature.sdk.pypi-dependencies]
f8pysdk = { path = "packages/f8pysdk", editable = true }

[feature.sdk.tasks]
runner = "python -m f8pysdk.headless_runner"
sdk_tests = 'python -m unittest discover -s packages/f8pysdk/tests -p "test_*.py"'
update_describes = "python scripts/update_static_describes.py"

[feature.engine.pypi-dependencies]
f8pyengine = { path = "packages/f8pyengine", editable = true }

[feature.engine.tasks]
f8pyengine = "python -m f8pyengine.main"

[feature.studio.pypi-dependencies]
f8pystudio = { path = "packages/f8pystudio", editable = true }
pyside6 = ">=6.10.2, <7"
qtpy = ">=2.4.3, <3"
pyqtgraph = ">=0.14.0, <0.15"
websockets = ">=16.0, <17"
aiortc = ">=1.14.0, <2"

[feature.studio.tasks]
f8pyengine = "python -m f8pystudio.main"

[feature.mediapipe.pypi-dependencies]
f8pymppose = { path = "packages/f8pymppose", editable = true }
mediapipe = ">=0.10.32, <0.11"

[feature.mediapipe.tasks]
f8pymppose = "python -m f8pymppose.main_pose"

[feature.doc.dependencies]
zensical = ">=0.0.23,<0.1.0"
pyyaml = ">=6.0.3,<7"

[feature.doc.tasks]
doc_build = "zensical build"
doc_serve = "zensical serve"
doc_check = "python scripts/generate_service_docs.py --check && python scripts/check_docs_nav.py && python scripts/check_docs_links.py"

[environments]
default = { features = ["python", "sdk", "engine", "studio", "vision"], solve-group = "default" }
onnx = { features = ["python", "sdk", "onnx", "vision"], solve-group = "onnx" }
mediapipe = { features = ["python", "sdk", "vision", "mediapipe"], solve-group = "mediapipe" }
doc = { features = ["doc"] }
